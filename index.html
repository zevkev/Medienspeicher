<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Medienspeicher Vista VM</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link id="dynamic-favicon" rel="icon">

<style>
/* ========== BASIS ========== */
html,body{
    margin:0;
    width:100%;
    height:100%;
    overflow:hidden;
    font-family:"Segoe UI",Tahoma,sans-serif;
    background:#000;
}
.hidden{display:none}

/* ========== BOOTLOADER ========== */
#boot{
    position:fixed;
    inset:0;
    background:black;
    color:white;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
}
#bar{
    width:240px;
    height:6px;
    background:#333;
    margin-top:20px;
    overflow:hidden;
    border-radius:4px;
}
#bar span{
    display:block;
    height:100%;
    width:0%;
    background:linear-gradient(90deg,#4fa3ff,#b6dcff);
    animation:load 4s linear forwards;
}
@keyframes load{
    to{width:100%}
}

/* ========== DESKTOP ========== */
#desktop{
    position:fixed;
    inset:0;
    background:linear-gradient(135deg,#355c9b,#0c1c2e);
    color:white;
}
.desktop-icons{
    padding:20px;
    display:flex;
    flex-wrap:wrap;
    gap:22px;
}
.icon{
    width:90px;
    text-align:center;
    cursor:pointer;
    user-select:none;
}
.icon span{
    font-size:42px;
    display:block;
}

/* ========== WINDOW (AERO) ========== */
.window{
    position:absolute;
    top:90px;
    left:90px;
    width:440px;
    background:rgba(255,255,255,.28);
    backdrop-filter: blur(16px);
    border-radius:14px;
    box-shadow:0 35px 90px rgba(0,0,0,.6);
    overflow:hidden;
}
.window-header{
    padding:8px 12px;
    background:linear-gradient(
        rgba(255,255,255,.7),
        rgba(255,255,255,.2)
    );
    display:flex;
    justify-content:space-between;
    cursor:move;
}
.window-content{
    background:rgba(255,255,255,.92);
    color:#000;
    padding:12px;
    max-height:320px;
    overflow:auto;
}

/* ========== EXPLORER ========== */
.explorer{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(90px,1fr));
    gap:14px;
}
.file{
    text-align:center;
    cursor:pointer;
}
.file span{
    font-size:36px;
}
.file small{
    display:block;
    word-break:break-word;
}

/* ========== TASKBAR ========== */
#taskbar{
    position:absolute;
    bottom:0;
    left:0;
    right:0;
    height:46px;
    background:linear-gradient(#111,#000);
    display:flex;
    align-items:center;
    padding:0 10px;
}
.task{
    margin-right:10px;
    cursor:pointer;
}

/* ========== LIGHTBOX ========== */
.lightbox{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.85);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:999;
}
.lightbox img{
    max-width:92%;
    max-height:92%;
    border-radius:14px;
}
</style>
</head>

<body>

<!-- BOOT -->
<div id="boot">
    <div>Windows is loading‚Ä¶</div>
    <div id="bar"><span></span></div>
</div>

<!-- DESKTOP -->
<div id="desktop" class="hidden">
    <div class="desktop-icons" id="icons"></div>
    <div id="taskbar">
        <div class="task" onclick="shutdown()">‚èª</div>
    </div>
</div>

<script>
/* ========== KONFIG ========== */
const IMAGE_NAMES = [
  "bello","Jamon","Medienspeicher","ZevKev",
  "DeathSwap","Survival","Temp"
];
const EXT = ["png","jpg","jpeg","webp"];
const PATHS = ["Bilder/","Bilder/mcserver/"];
let images=[];

/* ========== AUTO IMAGE FINDER ========== */
async function findImage(name){
    for(const p of PATHS){
        for(const e of EXT){
            const src=`${p}${name}.${e}`;
            const img=new Image();
            img.src=src;
            await new Promise(r=>{
                img.onload=()=>r(images.push({name,src,path:p}));
                img.onerror=r;
            });
            if(img.complete && img.naturalWidth) return;
        }
    }
}

/* ========== BOOT SEQUENCE ========== */
setTimeout(async()=>{
    for(const n of IMAGE_NAMES) await findImage(n);
    document.getElementById("boot").classList.add("hidden");
    document.getElementById("desktop").classList.remove("hidden");
    initDesktop();
    document.getElementById("dynamic-favicon").href=
      images[Math.floor(Math.random()*images.length)].src;
},4000);

/* ========== DESKTOP ICONS ========== */
function initDesktop(){
    const icons=document.getElementById("icons");
    icons.innerHTML="";

    icon("üìÇ","Explorer",()=>openExplorer(images));
    icon("üìÅ","Galerie",()=>openExplorer(images.filter(i=>!i.path.includes("mcserver"))));
    icon("üìÅ","MC-Server",()=>openExplorer(images.filter(i=>i.path.includes("mcserver"))));
    icon("‚ÑπÔ∏è","Info.txt",openInfo);
    icon("üåô","Day / Night",toggleTheme);
}

function icon(emoji,name,fn){
    const d=document.createElement("div");
    d.className="icon";
    d.innerHTML=`<span>${emoji}</span>${name}`;
    d.onclick=fn;
    document.getElementById("icons").appendChild(d);
}

/* ========== WINDOW SYSTEM ========== */
function openWindow(title,content){
    const w=document.createElement("div");
    w.className="window";
    w.innerHTML=`
      <div class="window-header">
        <b>${title}</b>
        <span onclick="this.closest('.window').remove()">‚úñ</span>
      </div>
      <div class="window-content">${content}</div>
    `;
    document.body.appendChild(w);
    drag(w);
}

/* ========== EXPLORER ========== */
function openExplorer(list){
    let html='<div class="explorer">';
    list.forEach(i=>{
        html+=`
        <div class="file" onclick="openImage('${i.src}','${i.name}')">
            <span>üñºÔ∏è</span>
            <small>${i.name}</small>
        </div>`;
    });
    html+='</div>';
    openWindow("Explorer",html);
}

function openImage(src,name){
    const lb=document.createElement("div");
    lb.className="lightbox";
    lb.onclick=()=>lb.remove();
    lb.innerHTML=`<img src="${src}">`;
    document.body.appendChild(lb);
}

/* ========== INFO ========== */
function openInfo(){
    openWindow("Info.txt",
    `Dies ist die Bildergallerie vom Medienspeicher.<br>
     Alle Bilder f√ºr Social Media, Einbettung & Archiv.`);
}

/* ========== THEME ========== */
function toggleTheme(){
    document.body.style.filter=
      document.body.style.filter?"":"invert(1)";
}

/* ========== DRAG + SNAP ========== */
function drag(win){
    const h=win.querySelector(".window-header");
    let ox,oy;
    h.onmousedown=e=>{
        ox=e.offsetX;
        oy=e.offsetY;
        document.onmousemove=m=>{
            win.style.left=(m.pageX-ox)+"px";
            win.style.top=(m.pageY-oy)+"px";

            if(m.pageX<20){
                win.style.left="0";
                win.style.top="0";
                win.style.width="50%";
                win.style.height="calc(100% - 46px)";
            }
            if(m.pageX>window.innerWidth-20){
                win.style.left="50%";
                win.style.top="0";
                win.style.width="50%";
                win.style.height="calc(100% - 46px)";
            }
        };
        document.onmouseup=()=>document.onmousemove=null;
    };
}

/* ========== SHUTDOWN ========== */
function shutdown(){
    document.body.innerHTML=
      "<div style='background:black;color:white;display:flex;align-items:center;justify-content:center;height:100%'>Herunterfahren‚Ä¶</div>";
    setTimeout(()=>location.href="https://zevkev.de",3000);
}
</script>

</body>
</html>

